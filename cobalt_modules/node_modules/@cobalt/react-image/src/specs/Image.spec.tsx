import React from "react";
import { render } from "@testing-library/react";
import Image, { ImageType } from "../Image";

const TEST_IMAGE_URL = "http://via.placeholder.com/225x40";
const TEST_ALT_TEXT = "Lorem ipsum dolor";

describe("<Image />", () => {
  it("renders", () => {
    const { container } = render(
      <Image src={TEST_IMAGE_URL} alt={TEST_ALT_TEXT} />
    );

    expect(container).toMatchSnapshot();
  });

  it("receives custom attribute", () => {
    const { getByTestId } = render(
      <Image
        src={TEST_IMAGE_URL}
        alt={TEST_ALT_TEXT}
        data-testid="image"
        data-custom="custom-attribute"
      />
    );

    expect(getByTestId("image").getAttribute("data-custom")).toEqual(
      "custom-attribute"
    );
  });

  it("supports custom additional classes", () => {
    const { getByTestId } = render(
      <Image
        src={TEST_IMAGE_URL}
        alt={TEST_ALT_TEXT}
        data-testid="image"
        className="test-class"
      />
    );

    expect(getByTestId("image").classList.value).toBe("co-image test-class");
  });

  it("renders with a ref", () => {
    const ref = React.createRef<ImageType>();

    const { getByTestId } = render(
      <Image
        src={TEST_IMAGE_URL}
        alt={TEST_ALT_TEXT}
        forwardedRef={ref}
        data-testid="test"
      />
    );

    expect(getByTestId("test")).toBe(ref.current);
  });
});
